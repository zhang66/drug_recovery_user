<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.blueocean.app.customermanage.dao.DrugRecycleSiteDao">
	<resultMap id="BaseResultMap"
		type="com.blueocean.app.customermanage.dto.DrugRecycleSiteDo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="account" property="account" jdbcType="VARCHAR" />
		<result column="password" property="password" jdbcType="VARCHAR" />
		<result column="site_name" property="siteName" jdbcType="VARCHAR" />
		<result column="site_type" property="siteType" jdbcType="INTEGER" />
		<result column="contact_name" property="contactName" jdbcType="VARCHAR" />
		<result column="contact_phone" property="contactPhone"
			jdbcType="VARCHAR" />
		<result column="province_name" property="provinceName"
			jdbcType="VARCHAR" />
		<result column="city_name" property="cityName" jdbcType="VARCHAR" />
		<result column="full_address" property="fullAddress" jdbcType="VARCHAR" />
		<result column="detail_address" property="detailAddress"
			jdbcType="VARCHAR" />
		<result column="is_active" property="isActive" jdbcType="CHAR" />
		<result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
		<result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
		<result column="province_id" property="provinceId" jdbcType="INTEGER" />
		<result column="city_id" property="cityId" jdbcType="INTEGER" />
		<result column="city_code" property="cityCode" jdbcType="VARCHAR" />
		<result column="lng" property="lng" jdbcType="VARCHAR" />
		<result column="lat" property="lat" jdbcType="VARCHAR" />
		<result column="auto_position" property="autoPosition"
			jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		id, account, password, site_name, site_type, contact_name,
		contact_phone, province_name,
		city_name, full_address,detail_address,
		is_active,
		gmt_create, gmt_modified, province_id,
		city_id,city_code,lng,lat,auto_position
	</sql>

	<sql id="Pharmacy_Column_List">
		id, account, password, site_name siteName, site_type AS
		siteType,
		contact_name AS contactName, contact_phone AS contactPhone,
		province_name AS provinceName,
		city_name AS cityName, full_address AS
		fullAddress, is_active AS isActive,
		date_format(gmt_create,'%Y-%m-%d')
		as gmtCreate,detail_address detailAddress,
		city_code
		cityCode,auto_position autoPosition,lng lng,lat lat
	</sql>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		select
		<include refid="Base_Column_List" />
		from drug_recycle_site
		where id = #{id,jdbcType=INTEGER}
	</select>
	<select id="selectBypassword" resultMap="BaseResultMap"
		parameterType="com.blueocean.app.assistantmanage.web.LoginUser">

		select
		<include refid="Base_Column_List" />
		from drug_recycle_site
		where account = #{userName} and password =
		#{passWord}
	</select>
	<!-- 查询账户是否存在 -->
	<select id="selectExistAccount" resultMap="BaseResultMap"
		parameterType="java.lang.String">

		select
		<include refid="Base_Column_List" />
		from drug_recycle_site
		where account = #{account}
	</select>

	<select id="listPharmacyByParams"
		resultType="com.blueocean.app.customermanage.entity.PharmacyResponseDTO"
		parameterType="hashMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		select
		<include refid="Pharmacy_Column_List" />
		from drug_recycle_site
		where 1=1
		<if test="id != null and id != ''">
			and id LIKE CONCAT(CONCAT('%',#{id}),'%')
		</if>
		<if test="siteName != null and siteName != ''">
			and site_name LIKE CONCAT(CONCAT('%',#{siteName}),'%')
		</if>
		<if test="PharmacyStatus != null and PharmacyStatus != ''">
			and is_active = #{PharmacyStatus,jdbcType=VARCHAR}
		</if>
		ORDER BY id
	</select>
	<!-- 根据经纬度查药店列表 -->
	<select id="listPharmacyInRange" resultType="com.blueocean.app.customermanage.entity.SiteInRangeDTO"
		parameterType="hashMap">
		select
		id,site_name name
		,full_address fullAddress
		,lng,lat
		,round(6378.138*2*asin(sqrt(pow(sin(
		(#{lat}*pi()/180-lat*pi()/180)/2),2)+cos(#{lat}*pi()/180)*cos(lat*pi()/180)*
		pow(sin( (#{lng}*pi()/180-lng*pi()/180)/2),2)))*1000) AS
		distance
		FROM
		drug_recycle_site
		having distance &lt;=5000
		ORDER BY
		distance ASC
	</select>

	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		delete from drug_recycle_site
		where id = #{id,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.blueocean.app.customermanage.dto.DrugRecycleSiteDo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		insert into drug_recycle_site (id, account, password,
		site_name,
		site_type, contact_name,
		contact_phone, province_name, city_name,
		full_address, is_active, gmt_create,
		gmt_modified, province_id,
		city_id,city_code,lng,lat,auto_position
		)
		values
		(#{id,jdbcType=INTEGER},
		#{account,jdbcType=VARCHAR},
		#{password,jdbcType=VARCHAR},
		#{siteName,jdbcType=VARCHAR},
		#{siteType,jdbcType=INTEGER},
		#{contactName,jdbcType=VARCHAR},
		#{contactPhone,jdbcType=VARCHAR},
		#{provinceName,jdbcType=VARCHAR},
		#{cityName,jdbcType=VARCHAR},
		#{fullAddress,jdbcType=VARCHAR},
		#{isActive,jdbcType=CHAR}, now(),
		now(),
		#{provinceId,jdbcType=INTEGER},
		#{cityId,jdbcType=INTEGER},
		#{cityCode,jdbcType=VARCHAR},
		#{lng,jdbcType=VARCHAR},
		#{lat,jdbcType=VARCHAR},
		#{autoPosition,jdbcType=VARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.blueocean.app.customermanage.dto.DrugRecycleSiteDo"
		keyProperty="id">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		insert into drug_recycle_site
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="account != null">
				account,
			</if>
			<if test="password != null">
				password,
			</if>
			<if test="siteName != null">
				site_name,
			</if>
			<if test="siteType != null">
				site_type,
			</if>
			<if test="contactName != null">
				contact_name,
			</if>
			<if test="contactPhone != null">
				contact_phone,
			</if>
			<if test="provinceName != null">
				province_name,
			</if>
			<if test="cityName != null">
				city_name,
			</if>
			<if test="fullAddress != null">
				full_address,
			</if>
			<if test="detailAddress != null">
				detail_address,
			</if>
			<if test="isActive != null">
				is_active,
			</if>
			<if test="gmtCreate != null">
				gmt_create,
			</if>
			<if test="gmtModified != null">
				gmt_modified,
			</if>
			<if test="provinceId != null">
				province_id,
			</if>
			<if test="cityId != null">
				city_id,
			</if>
			<if test="cityCode!=null">
				city_code,
			</if>
			<if test="lng != null">
				lng,
			</if>
			<if test="lat!=null">
				lat,
			</if>
			<if test="autoPosition!=null">
				auto_position,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=INTEGER},
			</if>
			<if test="account != null">
				#{account,jdbcType=VARCHAR},
			</if>
			<if test="password != null">
				#{password,jdbcType=VARCHAR},
			</if>
			<if test="siteName != null">
				#{siteName,jdbcType=VARCHAR},
			</if>
			<if test="siteType != null">
				#{siteType,jdbcType=INTEGER},
			</if>
			<if test="contactName != null">
				#{contactName,jdbcType=VARCHAR},
			</if>
			<if test="contactPhone != null">
				#{contactPhone,jdbcType=VARCHAR},
			</if>
			<if test="provinceName != null">
				#{provinceName,jdbcType=VARCHAR},
			</if>
			<if test="cityName != null">
				#{cityName,jdbcType=VARCHAR},
			</if>
			<if test="fullAddress != null">
				#{fullAddress,jdbcType=VARCHAR},
			</if>
			<if test="detailAddress != null">
				#{detailAddress,jdbcType=VARCHAR},
			</if>
			<if test="isActive != null">
				#{isActive,jdbcType=CHAR},
			</if>
			<if test="gmtCreate != null">
				#{gmtCreate,jdbcType=TIMESTAMP},
			</if>
			<if test="gmtModified != null">
				#{gmtModified,jdbcType=TIMESTAMP},
			</if>
			<if test="provinceId != null">
				#{provinceId,jdbcType=INTEGER},
			</if>
			<if test="cityId != null">
				#{cityId,jdbcType=INTEGER},
			</if>
			<if test="cityCode!=null">
				#{cityCode,jdbcType=VARCHAR},
			</if>
			<if test="lng!=null">
				#{lng,jdbcType=VARCHAR},
			</if>
			<if test="lat!=null">
				#{lat,jdbcType=VARCHAR},
			</if>
			<if test="autoPosition!=null">
				#{autoPosition,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.blueocean.app.customermanage.dto.DrugRecycleSiteDo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		update drug_recycle_site
		<set>
			<if test="password != null">
				password = #{password,jdbcType=VARCHAR},
			</if>
			<if test="siteName != null">
				site_name = #{siteName,jdbcType=VARCHAR},
			</if>
			<if test="siteType != null">
				site_type = #{siteType,jdbcType=INTEGER},
			</if>
			<if test="contactName != null">
				contact_name = #{contactName,jdbcType=VARCHAR},
			</if>
			<if test="contactPhone != null">
				contact_phone = #{contactPhone,jdbcType=VARCHAR},
			</if>
			<if test="provinceName != null">
				province_name = #{provinceName,jdbcType=VARCHAR},
			</if>
			<if test="cityName != null">
				city_name = #{cityName,jdbcType=VARCHAR},
			</if>
			<if test="fullAddress != null">
				full_address = #{fullAddress,jdbcType=VARCHAR},
			</if>
			<if test="detailAddress != null">
				detail_address = #{detailAddress,jdbcType=VARCHAR},
			</if>
			<if test="isActive != null">
				is_active = #{isActive,jdbcType=CHAR},
			</if>

			<if test="provinceId != null">
				province_id = #{provinceId,jdbcType=INTEGER},
			</if>
			<if test="cityId != null">
				city_id = #{cityId,jdbcType=INTEGER},
			</if>
			<if test="cityCode!=null">
				city_code=#{cityCode,jdbcType=VARCHAR},
			</if>
			<if test="lng!=null">
				lng=#{lng,jdbcType=VARCHAR},
			</if>
			<if test="lat!=null">
				lat=#{lat,jdbcType=VARCHAR},
			</if>
			<if test="autoPosition!=null">
				auto_position=#{autoPosition,jdbcType=VARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.blueocean.app.customermanage.dto.DrugRecycleSiteDo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 12 
			16:43:48 CST 2017. -->
		update drug_recycle_site
		set
		password = #{password,jdbcType=VARCHAR},
		site_name =
		#{siteName,jdbcType=VARCHAR},
		site_type = #{siteType,jdbcType=INTEGER},
		contact_name = #{contactName,jdbcType=VARCHAR},
		contact_phone =
		#{contactPhone,jdbcType=VARCHAR},
		province_name =
		#{provinceName,jdbcType=VARCHAR},
		city_name =
		#{cityName,jdbcType=VARCHAR},
		full_address =
		#{fullAddress,jdbcType=VARCHAR},
		detail_address =
		#{detailAddress,jdbcType=VARCHAR},
		is_active =
		#{isActive,jdbcType=CHAR},
		gmt_create =
		#{gmtCreate,jdbcType=TIMESTAMP},
		gmt_modified =
		#{gmtModified,jdbcType=TIMESTAMP},
		province_id =
		#{provinceId,jdbcType=INTEGER},
		city_id = #{cityId,jdbcType=INTEGER},
		city_code=#{cityCode,jdbcType=VARCHAR},
		lng=#{lng,jdbcType=VARCHAR},
		lat=#{lat,jdbcType=VARCHAR}
		where id =
		#{id,jdbcType=INTEGER}
	</update>
</mapper>